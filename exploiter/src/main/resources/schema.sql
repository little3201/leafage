-- ----------------------------
-- Table structure for links
-- ----------------------------
DROP TABLE IF EXISTS "public"."links";
CREATE TABLE "public"."links"
(
    "id"                 int8         NOT NULL GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    "host"               varchar(255),
    "port"               int4,
    "name"               varchar(255),
    "username"           varchar(255),
    "password"           varchar(255),
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6)
)
;
COMMENT
ON COLUMN "public"."links"."id" IS '主键';
COMMENT
ON COLUMN "public"."links"."host" IS '主机';
COMMENT
ON COLUMN "public"."links"."port" IS '端口';
COMMENT
ON COLUMN "public"."links"."name" IS '库名称';
COMMENT
ON COLUMN "public"."links"."username" IS '账号';
COMMENT
ON COLUMN "public"."links"."password" IS '密码';
COMMENT
ON COLUMN "public"."links"."enabled" IS '是否启用';
COMMENT
ON COLUMN "public"."links"."created_by" IS '创建者';
COMMENT
ON COLUMN "public"."links"."created_date" IS '创建时间';
COMMENT
ON COLUMN "public"."links"."last_modified_by" IS '最后修改者';
COMMENT
ON COLUMN "public"."links"."last_modified_date" IS '最后修改时间';
COMMENT
ON TABLE "public"."links" IS '数据库连接表';

-- ----------------------------
-- Table structure for schemas
-- ----------------------------
DROP TABLE IF EXISTS "public"."schemas";
CREATE TABLE "public"."schemas"
(
    "id"                 int8         NOT NULL GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    "name"               varchar(64),
    "package_path"       varchar(127),
    "prefix"             varchar(64),
    "templates"          varchar[],
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6),
    "link_id"            int8
)
;
COMMENT
ON COLUMN "public"."schemas"."id" IS '主键，自动生成';
COMMENT
ON COLUMN "public"."schemas"."name" IS '表名称';
COMMENT
ON COLUMN "public"."schemas"."package_path" IS '包名';
COMMENT
ON COLUMN "public"."schemas"."prefix" IS '前缀';
COMMENT
ON COLUMN "public"."schemas"."templates" IS '模板';
COMMENT
ON COLUMN "public"."schemas"."enabled" IS '是否启用';
COMMENT
ON COLUMN "public"."schemas"."created_by" IS '创建者';
COMMENT
ON COLUMN "public"."schemas"."created_date" IS '创建时间';
COMMENT
ON COLUMN "public"."schemas"."last_modified_by" IS '最后修改者';
COMMENT
ON COLUMN "public"."schemas"."last_modified_date" IS '最后修改时间';
COMMENT
ON COLUMN "public"."schemas"."link_id" IS 'link主键';
COMMENT
ON TABLE "public"."schemas" IS 'schema配置表';

-- ----------------------------
-- Table structure for fields
-- ----------------------------
DROP TABLE IF EXISTS "public"."fields";
CREATE TABLE "public"."fields"
(
    "id"                 int8         NOT NULL GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    "name"               varchar(64),
    "column_name"        varchar(64),
    "data_type"          varchar(64),
    "length"             int2,
    "field_type"         varchar(16),
    "form_type"          varchar(16),
    "ts_type"            varchar(16),
    "schema_id"          int8         NOT NULL,
    "nullable"           bool,
    "is_unique"          bool, ,
    "query_type"         varchar(255),
    "sortable"           bool,
    "queryable"          bool,
    "editable"           bool,
    "comment"            text,
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6)
)
;
COMMENT
ON COLUMN "public"."fields"."id" IS '主键，自动生成';
COMMENT
ON COLUMN "public"."fields"."name" IS '属性命';
COMMENT
ON COLUMN "public"."fields"."column_name" IS '字段名';
COMMENT
ON COLUMN "public"."fields"."data_type" IS '字段类型';
COMMENT
ON COLUMN "public"."fields"."length" IS '字段长度';
COMMENT
ON COLUMN "public"."fields"."field_type" IS '属性类型';
COMMENT
ON COLUMN "public"."fields"."form_type" IS '表单类型';
COMMENT
ON COLUMN "public"."fields"."ts_type" IS 'ts类型';
COMMENT
ON COLUMN "public"."fields"."schema_id" IS 'schema主键';
COMMENT
ON COLUMN "public"."fields"."nullable" IS '是否允许为空';
COMMENT
ON COLUMN "public"."fields"."is_unique" IS '是否唯一';
COMMENT
ON COLUMN "public"."fields"."query_type" IS '查询类型';
COMMENT
ON COLUMN "public"."fields"."sortable" IS '是否可排序';
COMMENT
ON COLUMN "public"."fields"."queryable" IS '是否可查询';
COMMENT
ON COLUMN "public"."fields"."editable" IS '是否可编辑';
COMMENT
ON COLUMN "public"."fields"."comment" IS '注释';
COMMENT
ON COLUMN "public"."fields"."enabled" IS '是否启用';
COMMENT
ON COLUMN "public"."fields"."created_by" IS '创建者';
COMMENT
ON COLUMN "public"."fields"."created_date" IS '创建时间';
COMMENT
ON COLUMN "public"."fields"."last_modified_by" IS '最后修改者';
COMMENT
ON COLUMN "public"."fields"."last_modified_date" IS '最后修改时间';
COMMENT
ON TABLE "public"."fields" IS '属性配置表';


-- ----------------------------
-- Table structure for scripts
-- ----------------------------
DROP TABLE IF EXISTS "public"."scripts";
CREATE TABLE "public"."scripts"
(
    "id"                 int8         NOT NULL GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    "name"               varchar(64),
    "icon"               varchar(255),
    "version"            varchar(16),
    "content"            text,
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6),
    "type"               varchar(16)
)
;
COMMENT
ON COLUMN "public"."scripts"."id" IS '主键，自动生成';
COMMENT
ON COLUMN "public"."scripts"."name" IS '名称';
COMMENT
ON COLUMN "public"."scripts"."icon" IS '图标';
COMMENT
ON COLUMN "public"."scripts"."version" IS '版本';
COMMENT
ON COLUMN "public"."scripts"."content" IS '内容';
COMMENT
ON COLUMN "public"."scripts"."enabled" IS '是否启用';
COMMENT
ON COLUMN "public"."scripts"."created_by" IS '创建者';
COMMENT
ON COLUMN "public"."scripts"."created_date" IS '创建时间';
COMMENT
ON COLUMN "public"."scripts"."last_modified_by" IS '最后修改者';
COMMENT
ON COLUMN "public"."scripts"."last_modified_date" IS '最后修改时间';
COMMENT
ON COLUMN "public"."scripts"."type" IS '类型';
COMMENT
ON TABLE "public"."scripts" IS '脚本配置表';

-- ----------------------------
-- Table structure for templates
-- ----------------------------
DROP TABLE IF EXISTS "public"."templates";
CREATE TABLE "public"."templates"
(
    "id"                 int8         NOT NULL GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    "name"               varchar(64)  NOT NULL,
    "suffix"             varchar(16)  NOT NULL,
    "content"            text,
    "type"               varchar(16),
    "version"            varchar(16)  NOT NULL,
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6)
)
;
COMMENT
ON COLUMN "public"."templates"."id" IS '主键，自动生成';
COMMENT
ON COLUMN "public"."templates"."name" IS '表名称';
COMMENT
ON COLUMN "public"."templates"."suffix" IS '文件后缀';
COMMENT
ON COLUMN "public"."templates"."content" IS '模板内容';
COMMENT
ON COLUMN "public"."templates"."type" IS '类型';
COMMENT
ON COLUMN "public"."templates"."version" IS '版本号';
COMMENT
ON COLUMN "public"."templates"."enabled" IS '是否启用';
COMMENT
ON COLUMN "public"."templates"."created_by" IS '创建者';
COMMENT
ON COLUMN "public"."templates"."created_date" IS '创建时间';
COMMENT
ON COLUMN "public"."templates"."last_modified_by" IS '最后修改者';
COMMENT
ON COLUMN "public"."templates"."last_modified_date" IS '最后修改时间';
COMMENT
ON TABLE "public"."templates" IS '模板表';


-- ----------------------------
-- Indexes structure for table templates
-- ----------------------------
CREATE UNIQUE INDEX "ix_templates_name_suffix_version" ON "public"."templates" USING btree (
    "name" "pg_catalog"."text_ops" ASC NULLS LAST,
    "suffix" "pg_catalog"."text_ops" ASC NULLS LAST,
    "version" "pg_catalog"."text_ops" ASC NULLS LAST
    );

-- ----------------------------
-- Uniques structure for table templates
-- ----------------------------
ALTER TABLE "public"."templates"
    ADD CONSTRAINT "templates_name_suffix_version_key" UNIQUE ("name", "suffix", "version");

-- ----------------------------
-- Primary Key structure for table templates
-- ----------------------------
ALTER TABLE "public"."templates"
    ADD CONSTRAINT "templates_pkey" PRIMARY KEY ("id");

-- ----------------------------
-- Foreign Keys structure for table schemas
-- ----------------------------
ALTER TABLE "public"."schemas"
    ADD CONSTRAINT "fk_shcemas_link_id" FOREIGN KEY ("link_id") REFERENCES "public"."links" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;

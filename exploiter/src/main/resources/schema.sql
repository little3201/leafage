-- ----------------------------
-- Table structure for connections
-- ----------------------------
DROP TABLE IF EXISTS "public"."connections";
CREATE TABLE "public"."connections"
(
    "id"                 int8         NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "host"               varchar(255),
    "port"               int4,
    "name"               varchar(255),
    "username"           varchar(255),
    "password"           varchar(255),
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6)
)
;
COMMENT
    ON COLUMN "public"."connections"."id" IS '主键';
COMMENT
    ON COLUMN "public"."connections"."host" IS '主机';
COMMENT
    ON COLUMN "public"."connections"."port" IS '端口';
COMMENT
    ON COLUMN "public"."connections"."name" IS '库名称';
COMMENT
    ON COLUMN "public"."connections"."username" IS '账号';
COMMENT
    ON COLUMN "public"."connections"."password" IS '密码';
COMMENT
    ON COLUMN "public"."connections"."enabled" IS '是否启用';
COMMENT
    ON COLUMN "public"."connections"."created_by" IS '创建者';
COMMENT
    ON COLUMN "public"."connections"."created_date" IS '创建时间';
COMMENT
    ON COLUMN "public"."connections"."last_modified_by" IS '最后修改者';
COMMENT
    ON COLUMN "public"."connections"."last_modified_date" IS '最后修改时间';
COMMENT
    ON TABLE "public"."connections" IS '数据库连接表';

-- ----------------------------
-- Table structure for schemas
-- ----------------------------
DROP TABLE IF EXISTS "public"."schemas";
CREATE TABLE "public"."schemas"
(
    "id"                 int8         NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "name"               varchar(64),
    "package_name"       varchar(127),
    "prefix"             varchar(64),
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6),
    "connection_id"      int8
)
;
COMMENT
    ON COLUMN "public"."schemas"."id" IS '主键，自动生成';
COMMENT
    ON COLUMN "public"."schemas"."name" IS '表名称';
COMMENT
    ON COLUMN "public"."schemas"."package_name" IS '包名';
COMMENT
    ON COLUMN "public"."schemas"."prefix" IS '前缀';
COMMENT
    ON COLUMN "public"."schemas"."enabled" IS '是否启用';
COMMENT
    ON COLUMN "public"."schemas"."created_by" IS '创建者';
COMMENT
    ON COLUMN "public"."schemas"."created_date" IS '创建时间';
COMMENT
    ON COLUMN "public"."schemas"."last_modified_by" IS '最后修改者';
COMMENT
    ON COLUMN "public"."schemas"."last_modified_date" IS '最后修改时间';
COMMENT
    ON COLUMN "public"."schemas"."connection_id" IS 'connection主键';
COMMENT
    ON TABLE "public"."schemas" IS 'schema配置表';


-- ----------------------------
-- Table structure for schema_templates
-- ----------------------------
DROP TABLE IF EXISTS "public"."schema_templates";
CREATE TABLE "public"."schema_templates"
(
    "id"        int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "schema_id" int8 NOT NULL,
    "template"  int8 NOT NULL
)
;
COMMENT ON COLUMN "public"."schema_templates"."id" IS '主键';
COMMENT ON COLUMN "public"."schema_templates"."schema_id" IS 'schema主键';
COMMENT ON COLUMN "public"."schema_templates"."template" IS 'samples主键';


-- ----------------------------
-- Primary Key structure for table schema_templates
-- ----------------------------
ALTER TABLE "public"."schema_templates"
    ADD CONSTRAINT "schema_templates_pkey" PRIMARY KEY ("id");

-- ----------------------------
-- Foreign Keys structure for table schema_templates
-- ----------------------------
ALTER TABLE "public"."schema_templates"
    ADD CONSTRAINT "fk_schema_templates_schema_id" FOREIGN KEY ("schema_id") REFERENCES "public"."schemas" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;
ALTER TABLE "public"."schema_templates"
    ADD CONSTRAINT "fk_schema_templates_template" FOREIGN KEY ("template") REFERENCES "public"."samples" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;

-- ----------------------------
-- Table structure for fields
-- ----------------------------
DROP TABLE IF EXISTS "public"."fields";
CREATE TABLE "public"."fields"
(
    "id"                 int8         NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "name"               varchar(64),
    "data_type"          varchar(64),
    "length"             int2,
    "field_type"         varchar(16),
    "form_type"          varchar(16),
    "ts_type"            varchar(16),
    "schema_id"          int8         NOT NULL,
    "nullable"           bool,
    "is_unique"          bool,
    "query_type"         varchar(255),
    "sortable"           bool,
    "queryable"          bool,
    "editable"           bool,
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6)
)
;
COMMENT
    ON COLUMN "public"."fields"."id" IS '主键，自动生成';
COMMENT
    ON COLUMN "public"."fields"."name" IS '属性命';
COMMENT
    ON COLUMN "public"."fields"."data_type" IS '字段类型';
COMMENT
    ON COLUMN "public"."fields"."length" IS '字段长度';
COMMENT
    ON COLUMN "public"."fields"."field_type" IS '属性类型';
COMMENT
    ON COLUMN "public"."fields"."form_type" IS '表单类型';
COMMENT
    ON COLUMN "public"."fields"."ts_type" IS 'ts类型';
COMMENT
    ON COLUMN "public"."fields"."schema_id" IS 'schema主键';
COMMENT
    ON COLUMN "public"."fields"."nullable" IS '是否允许为空';
COMMENT
    ON COLUMN "public"."fields"."is_unique" IS '是否唯一';
COMMENT
    ON COLUMN "public"."fields"."query_type" IS '查询类型';
COMMENT
    ON COLUMN "public"."fields"."sortable" IS '是否可排序';
COMMENT
    ON COLUMN "public"."fields"."queryable" IS '是否可查询';
COMMENT
    ON COLUMN "public"."fields"."editable" IS '是否可编辑';
COMMENT
    ON COLUMN "public"."fields"."enabled" IS '是否启用';
COMMENT
    ON COLUMN "public"."fields"."created_by" IS '创建者';
COMMENT
    ON COLUMN "public"."fields"."created_date" IS '创建时间';
COMMENT
    ON COLUMN "public"."fields"."last_modified_by" IS '最后修改者';
COMMENT
    ON COLUMN "public"."fields"."last_modified_date" IS '最后修改时间';
COMMENT
    ON TABLE "public"."fields" IS '属性配置表';


-- ----------------------------
-- Table structure for scripts
-- ----------------------------
DROP TABLE IF EXISTS "public"."scripts";
CREATE TABLE "public"."scripts"
(
    "id"                 int8         NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "name"               varchar(64),
    "icon"               varchar(255),
    "version"            varchar(16),
    "content"            text,
    "enabled"            bool         NOT NULL DEFAULT true,
    "created_by"         varchar(64),
    "created_date"       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "last_modified_by"   varchar(64),
    "last_modified_date" timestamp(6),
    "type"               varchar(16)
)
;
COMMENT
    ON COLUMN "public"."scripts"."id" IS '主键，自动生成';
COMMENT
    ON COLUMN "public"."scripts"."name" IS '名称';
COMMENT
    ON COLUMN "public"."scripts"."icon" IS '图标';
COMMENT
    ON COLUMN "public"."scripts"."version" IS '版本';
COMMENT
    ON COLUMN "public"."scripts"."content" IS '内容';
COMMENT
    ON COLUMN "public"."scripts"."enabled" IS '是否启用';
COMMENT
    ON COLUMN "public"."scripts"."created_by" IS '创建者';
COMMENT
    ON COLUMN "public"."scripts"."created_date" IS '创建时间';
COMMENT
    ON COLUMN "public"."scripts"."last_modified_by" IS '最后修改者';
COMMENT
    ON COLUMN "public"."scripts"."last_modified_date" IS '最后修改时间';
COMMENT
    ON COLUMN "public"."scripts"."type" IS '类型';
COMMENT
    ON TABLE "public"."scripts" IS '脚本配置表';

-- ----------------------------
-- Table structure for samples
-- ----------------------------
DROP TABLE IF EXISTS "public"."samples";
CREATE TABLE "public"."samples" (
  "id" int8         NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "name" varchar(64) COLLATE "pg_catalog"."default" NOT NULL,
  "suffix" varchar(16) COLLATE "pg_catalog"."default" NOT NULL,
  "content" text COLLATE "pg_catalog"."default",
  "type" varchar(16) COLLATE "pg_catalog"."default",
  "category" varchar(16) COLLATE "pg_catalog"."default" NOT NULL,
  "enabled" bool NOT NULL DEFAULT true,
  "created_by" varchar(64) COLLATE "pg_catalog"."default",
  "created_date" timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "last_modified_by" varchar(64) COLLATE "pg_catalog"."default",
  "last_modified_date" timestamp(6)
)
;
COMMENT ON COLUMN "public"."samples"."id" IS '主键，自动生成';
COMMENT ON COLUMN "public"."samples"."name" IS '表名称';
COMMENT ON COLUMN "public"."samples"."suffix" IS '文件后缀';
COMMENT ON COLUMN "public"."samples"."content" IS '模板内容';
COMMENT ON COLUMN "public"."samples"."type" IS '类型';
COMMENT ON COLUMN "public"."samples"."category" IS '类别';
COMMENT ON COLUMN "public"."samples"."enabled" IS '是否启用';
COMMENT ON COLUMN "public"."samples"."created_by" IS '创建者';
COMMENT ON COLUMN "public"."samples"."created_date" IS '创建时间';
COMMENT ON COLUMN "public"."samples"."last_modified_by" IS '最后修改者';
COMMENT ON COLUMN "public"."samples"."last_modified_date" IS '最后修改时间';
COMMENT ON TABLE "public"."samples" IS '样板表';

-- ----------------------------
-- Indexes structure for table samples
-- ----------------------------
CREATE UNIQUE INDEX "ix_samples_name_suffix_type" ON "public"."samples" USING btree (
  "name" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST,
  "suffix" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST,
  "type" COLLATE "pg_catalog"."default" "pg_catalog"."text_ops" ASC NULLS LAST
);



-- ----------------------------
-- Table structure for schema_samples
-- ----------------------------
DROP TABLE IF EXISTS "public"."schema_samples";
CREATE TABLE "public"."schema_samples" (
  "id" int8         NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "schema_id" int8 NOT NULL,
  "sample_id" int8 NOT NULL
)
;
COMMENT ON COLUMN "public"."schema_samples"."id" IS '主键';
COMMENT ON COLUMN "public"."schema_samples"."schema_id" IS 'schema主键';
COMMENT ON COLUMN "public"."schema_samples"."sample_id" IS 'sample主键';
COMMENT ON TABLE "public"."schema_samples" IS 'schema 样板关联表';

-- ----------------------------
-- Foreign Keys structure for table schema_samples
-- ----------------------------
ALTER TABLE "public"."schema_samples" ADD CONSTRAINT "fk_shcemas_samples_sample_id" FOREIGN KEY ("sample_id") REFERENCES "public"."samples" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;
ALTER TABLE "public"."schema_samples" ADD CONSTRAINT "fk_shcemas_samples_schema_id" FOREIGN KEY ("schema_id") REFERENCES "public"."schemas" ("id") ON DELETE NO ACTION ON UPDATE NO ACTION;

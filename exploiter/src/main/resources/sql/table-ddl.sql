/*
 * Copyright (c) 2025.  little3201.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *       https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*
 * Copyright (c) 2024.  little3201.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *       https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/*
 Navicat Premium Dump SQL

 Source Server         : 127-posrgres
 Source Server Type    : PostgreSQL
 Source Server Version : 160001 (160001)
 Source Host           : localhost:5432
 Source Catalog        : postgres
 Source Schema         : public

 Target Server Type    : PostgreSQL
 Target Server Version : 160001 (160001)
 File Encoding         : 65001

 Date: 25/10/2024 16:16:19
*/


-- ----------------------------
-- Table structure for schemas
-- ----------------------------
DROP TABLE IF EXISTS schemas;
CREATE TABLE schemas
(
    id                 bigint GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name               varchar(64),
    comment            varchar(64),
    reference          varchar(127),
    domain             varchar(64),
    templates          varchar[],
    enabled            bool         NOT NULL DEFAULT true,
    created_by         varchar(64),
    created_date       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    last_modified_by   varchar(64),
    last_modified_date timestamp(6)
);
COMMENT
ON COLUMN schemas.id IS '主键，自动生成';
COMMENT
ON COLUMN schemas.name IS '表名';
COMMENT
ON COLUMN schemas.comment IS '注释';
COMMENT
ON COLUMN schemas.reference IS '引用路径';
COMMENT
ON COLUMN schemas.domain IS '领域名';
COMMENT
ON COLUMN schemas.templates IS '模板';
COMMENT
ON COLUMN schemas.enabled IS '是否启用';
COMMENT
ON COLUMN schemas.created_by IS '创建者';
COMMENT
ON COLUMN schemas.created_date IS '创建时间';
COMMENT
ON COLUMN schemas.last_modified_by IS '最后修改者';
COMMENT
ON COLUMN schemas.last_modified_date IS '最后修改时间';
COMMENT
ON TABLE schemas IS 'schema配置表';


-- ----------------------------
-- Table structure for fields
-- ----------------------------
DROP TABLE IF EXISTS fields;
CREATE TABLE fields
(
    id                 bigint GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name               varchar(64),
    column_name        varchar(64),
    data_type          varchar(64),
    length             int2,
    field_type         varchar(16),
    form_type          varchar(16),
    ts_type            varchar(16),
    schema_id          bigint       not null,
    nullable           bool,
    is_unique          bool,
    queryable          bool,
    editable           bool,
    comment            text,
    enabled            bool         NOT NULL DEFAULT true,
    created_by         varchar(64),
    created_date       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    last_modified_by   varchar(64),
    last_modified_date timestamp(6),
    CONSTRAINT fk_fields_schemas FOREIGN KEY (schema_id) references schemas (id)
);
COMMENT
ON COLUMN fields.id IS '主键，自动生成';
COMMENT
ON COLUMN fields.schema_id IS 'schema主键';
COMMENT
ON COLUMN fields.name IS '属性名';
COMMENT
ON COLUMN fields.column_name IS '字段名';
COMMENT
ON COLUMN fields.data_type IS '字段类型';
COMMENT
ON COLUMN fields.length IS '字段长度';
COMMENT
ON COLUMN fields.field_type IS '属性类型';
COMMENT
ON COLUMN fields.form_type IS '表单类型';
COMMENT
ON COLUMN fields.ts_type IS 'ts类型';
COMMENT
ON COLUMN fields.nullable IS '是否允许为空';
COMMENT
ON COLUMN fields.is_unique IS '是否唯一';
COMMENT
ON COLUMN fields.queryable IS '是否可查询';
COMMENT
ON COLUMN fields.editable IS '是否可编辑';
COMMENT
ON COLUMN fields.comment IS '注释';
COMMENT
ON COLUMN fields.enabled IS '是否启用';
COMMENT
ON COLUMN fields.created_by IS '创建者';
COMMENT
ON COLUMN fields.created_date IS '创建时间';
COMMENT
ON COLUMN fields.last_modified_by IS '最后修改者';
COMMENT
ON COLUMN fields.last_modified_date IS '最后修改时间';
COMMENT
ON TABLE fields IS '属性配置表';

-- ----------------------------
-- Table structure for scripts
-- ----------------------------
DROP TABLE IF EXISTS scripts;
CREATE TABLE scripts
(
    id                 bigint GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name               varchar(64),
    icon               varchar(255),
    version            varchar(16),
    description        text,
    enabled            bool         NOT NULL DEFAULT true,
    created_by         varchar(64),
    created_date       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    last_modified_by   varchar(64),
    last_modified_date timestamp(6)
);
COMMENT
ON COLUMN scripts.id IS '主键，自动生成';
COMMENT
ON COLUMN scripts.name IS '名称';
COMMENT
ON COLUMN scripts.icon IS '图标';
COMMENT
ON COLUMN scripts.version IS '版本';
COMMENT
ON COLUMN scripts.description IS '表的描述';
COMMENT
ON COLUMN scripts.enabled IS '是否启用';
COMMENT
ON COLUMN scripts.created_by IS '创建者';
COMMENT
ON COLUMN scripts.created_date IS '创建时间';
COMMENT
ON COLUMN scripts.last_modified_by IS '最后修改者';
COMMENT
ON COLUMN scripts.last_modified_date IS '最后修改时间';
COMMENT
ON TABLE scripts IS '脚本配置表';


-- ----------------------------
-- Table structure for templates
-- ----------------------------
DROP TABLE IF EXISTS templates;
CREATE TABLE templates
(
    id                 bigint GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name               varchar(64)  NOT NULL,
    suffix             varchar(16)  NOT NULL,
    content            text,
    type               bigint,
    version            varchar(16)  NOT NULL,
    enabled            bool         NOT NULL DEFAULT true,
    created_by         varchar(64),
    created_date       timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    last_modified_by   varchar(64),
    last_modified_date timestamp(6),
    CONSTRAINT templates_name_suffix_version_key UNIQUE (name, suffix, version)
);
COMMENT
ON COLUMN templates.id IS '主键，自动生成';
COMMENT
ON COLUMN templates.name IS '名称';
COMMENT
ON COLUMN templates.suffix IS '后缀';
COMMENT
ON COLUMN templates.content IS '模板内容';
COMMENT
ON COLUMN templates.type IS '类型';
COMMENT
ON COLUMN templates.version IS '版本号';
COMMENT
ON COLUMN templates.enabled IS '是否启用';
COMMENT
ON COLUMN templates.created_by IS '创建者';
COMMENT
ON COLUMN templates.created_date IS '创建时间';
COMMENT
ON COLUMN templates.last_modified_by IS '最后修改者';
COMMENT
ON COLUMN templates.last_modified_date IS '最后修改时间';
COMMENT
ON TABLE templates IS '模板表';
